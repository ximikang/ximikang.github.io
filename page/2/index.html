<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="做有趣的事情"><meta name="keywords" content="ximikang"><meta name="author" content="ximikang"><meta name="copyright" content="ximikang"><title>Thinking will not overcome fear but action will. | Ximikang Blog</title><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.7.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.7.0"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?f85af80135b096b6028fbf812d7317c4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><link rel="dns-prefetch" href="https://www.google-analytics.com"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-139191409-1', 'auto');
ga('send', 'pageview');</script><link rel="dns-prefetch" href="http://ta.qq.com"><script>(function() {
   var hm = document.createElement("script");
   hm.src = "https://tajs.qq.com/stats?sId=66526162";
   var s = document.getElementsByTagName("script")[0];
   s.parentNode.insertBefore(hm, s);
 })();</script><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script><meta name="generator" content="Hexo 4.2.1"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="author-info"><div class="author-info__avatar text-center"><img src="/images/avatar.jpg"></div><div class="author-info__name text-center">ximikang</div><div class="author-info__description text-center">做有趣的事情</div><div class="follow-button"><a href="https://github.com/ximikang" target="_blank" rel="noopener">follow me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">24</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">42</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="https://master2334.github.io" target="_blank" rel="noopener">Master2334</a></div></div></div><nav id="nav" style="background-image: url(/images/bk.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Ximikang Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/gallery">Gallery</a><a class="site-page" href="/about">About</a></span><span class="pull-right"></span></div><div id="site-info"><div id="site-title">Ximikang Blog</div><div id="site-sub-title">Thinking will not overcome fear but action will.</div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2020/12/06/linux-homework/">多进程双buffer读取并处理</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-12-06</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/linux/">linux</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%A4%9A%E8%BF%9B%E7%A8%8B/">多进程</a></span><div class="content"><h2 id="题目要求"><a href="#题目要求" class="headerlink" title="题目要求"></a>题目要求</h2><p>编写Linux平台下的两个C语言程序实现如下功能：<br>（1）X、Y两个进程相互配合实现对输入文件中数据的处理，并将处理结果写入输出文件。<br>（2）X进程负责读分块取输入文件，并将输入数据利用共享内存传输给Y进程。<br>（3）Y进程负责将读入的数据（假定皆为文本数据）全部处理成大写，然后写入输出文件。<br>（4）为提高并行效率，X、Y两个进程之间创建2个共享内存区A、B。X读入数据到A区，然后用Linux的信号或信号量机制通知Y进程进行处理；在Y处理A区数据时，X继续读入数据到B区；B区数据被填满之后，X进程通知Y进程处理，自己再继续向A区读入数据。如此循环直至全部数据处理完毕。</p>
<h2 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ipc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/shm.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> BUFFER_SIZE = <span class="number">2048</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> <span class="keyword">const</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">argv[<span class="number">1</span>];</span><br><span class="line">    <span class="comment">// 文件</span></span><br><span class="line">    <span class="keyword">int</span> inputFile, outputFile;</span><br><span class="line">    inputFile = <span class="built_in">open</span>(argv[<span class="number">1</span>], O_RDONLY);</span><br><span class="line">    <span class="keyword">if</span>(inputFile &lt;= <span class="number">0</span> )&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"no file %s \n"</span>, argv[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    outputFile = <span class="built_in">open</span>(<span class="string">"./output.txt"</span>, O_WRONLY | O_CREAT, <span class="number">0666</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 信号量</span></span><br><span class="line">    <span class="keyword">sem_t</span> *sem1;</span><br><span class="line">    <span class="keyword">sem_t</span> *sem2;</span><br><span class="line">    sem1 = sem_open(<span class="string">"sem1"</span>, O_CREAT, <span class="number">0666</span>, <span class="number">1</span>);</span><br><span class="line">    sem2 = sem_open(<span class="string">"sem2"</span>, O_CREAT, <span class="number">0666</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 共享内存</span></span><br><span class="line">    <span class="comment">// 定义交换空间结构体</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">switchBuffer</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">char</span> <span class="built_in">buffer</span>[BUFFER_SIZE];</span><br><span class="line">        <span class="keyword">int</span> flag;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">switchBuffer</span> *<span class="title">buffera</span>;</span> <span class="comment">// 交换空间a，b</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">switchBuffer</span> *<span class="title">bufferb</span>;</span></span><br><span class="line">    <span class="keyword">int</span> shmaId, shmbId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建共享内存</span></span><br><span class="line">    shmaId = shmget((<span class="keyword">key_t</span>)<span class="number">11</span>, <span class="keyword">sizeof</span>(buffera), <span class="number">0666</span> | IPC_CREAT);</span><br><span class="line">    shmbId = shmget((<span class="keyword">key_t</span>)<span class="number">22</span>, <span class="keyword">sizeof</span>(bufferb), <span class="number">0666</span> | IPC_CREAT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 主进程读取数据</span></span><br><span class="line">    <span class="comment">// 子进程处理后写入数据</span></span><br><span class="line">    <span class="keyword">pid_t</span> cpid;</span><br><span class="line">    cpid = fork();</span><br><span class="line">    <span class="keyword">if</span> (cpid &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"error in fork\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cpid == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 子进程</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"child process pid: %d \t"</span>, getpid());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 共享内存映射到进程空间</span></span><br><span class="line">        buffera = (struct switchBuffer *)shmat(shmaId, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        bufferb = (struct switchBuffer *)shmat(shmbId, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> switchFlag = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sem_wait(sem2);</span><br><span class="line">            <span class="keyword">if</span> (switchFlag)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; buffera-&gt;flag; ++i)</span><br><span class="line">                &#123;</span><br><span class="line">                    buffera-&gt;<span class="built_in">buffer</span>[i] = <span class="built_in">toupper</span>(buffera-&gt;<span class="built_in">buffer</span>[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">write</span>(outputFile, buffera-&gt;<span class="built_in">buffer</span>, buffera-&gt;flag);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bufferb-&gt;flag; ++i)</span><br><span class="line">                &#123;</span><br><span class="line">                    bufferb-&gt;<span class="built_in">buffer</span>[i] = <span class="built_in">toupper</span>(bufferb-&gt;<span class="built_in">buffer</span>[i]);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">write</span>(outputFile, bufferb-&gt;<span class="built_in">buffer</span>, bufferb-&gt;flag);</span><br><span class="line">            &#125;</span><br><span class="line">            switchFlag = !switchFlag;</span><br><span class="line">            sem_post(sem1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 主进程</span></span><br><span class="line">        <span class="comment">// 共享内存映射到进程空间</span></span><br><span class="line">        buffera = (struct switchBuffer *)shmat(shmaId, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        bufferb = (struct switchBuffer *)shmat(shmbId, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> fileFlag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> switchFlag = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1.读取文件-&gt;buffer a</span></span><br><span class="line">        <span class="comment">// 2.等待处理进程</span></span><br><span class="line">        <span class="comment">// 3.触发处理进程</span></span><br><span class="line">        <span class="comment">// 4.读取文件-&gt;buffer b</span></span><br><span class="line">        <span class="comment">// 5.等待处理进程</span></span><br><span class="line">        <span class="comment">// 6.触发处理进程</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 开始时预先触发2,开始运行任务</span></span><br><span class="line">        <span class="comment">// 通过read文件为0判断终止条件</span></span><br><span class="line">        <span class="comment">// 终止后再次等待处理线程处理最后的一个buffer</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (switchFlag)</span><br><span class="line">            &#123;</span><br><span class="line">                fileFlag = <span class="built_in">read</span>(inputFile, buffera-&gt;<span class="built_in">buffer</span>, BUFFER_SIZE);</span><br><span class="line">                buffera-&gt;flag = fileFlag;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                fileFlag = <span class="built_in">read</span>(inputFile, bufferb-&gt;<span class="built_in">buffer</span>, BUFFER_SIZE);</span><br><span class="line">                bufferb-&gt;flag = fileFlag;</span><br><span class="line">            &#125;</span><br><span class="line">            switchFlag = !switchFlag;</span><br><span class="line">            <span class="keyword">if</span> (fileFlag &lt;= <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            sem_wait(sem1);</span><br><span class="line">            sem_post(sem2);</span><br><span class="line">        &#125;</span><br><span class="line">        sem_wait(sem1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// destory</span></span><br><span class="line">    <span class="built_in">close</span>(inputFile);</span><br><span class="line">    <span class="built_in">close</span>(outputFile);</span><br><span class="line">    sem_close(sem1);</span><br><span class="line">    sem_close(sem2);</span><br><span class="line">    sem_unlink(<span class="string">"sem1"</span>);</span><br><span class="line">    sem_unlink(<span class="string">"sem2"</span>);</span><br><span class="line">    shmdt(buffera);</span><br><span class="line">    shmdt(bufferb);</span><br><span class="line">    shmctl(shmaId, IPC_RMID, <span class="number">0</span>);</span><br><span class="line">    shmctl(shmbId, IPC_RMID, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"over\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/12/06/opencv%E7%BB%BF%E5%B9%95%E6%8A%A0%E5%9B%BE/">使用OpenCV抠图</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-12-06</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/opencv/">opencv</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%8A%A0%E5%9B%BE/">抠图</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%BB%BF%E5%B9%95/">绿幕</a></span><div class="content"><h2 id="颜色空间"><a href="#颜色空间" class="headerlink" title="颜色空间"></a>颜色空间</h2><p>颜色空间是对颜色的一种表述，但是颜色本来就是客观存在的，不同的颜色空间只是通过不同的角度去衡量同一个颜色。常见的颜色空间主要有基于颜色的还有亮度分离的颜色空间。</p>
<h3 id="RGB颜色空间"><a href="#RGB颜色空间" class="headerlink" title="RGB颜色空间"></a>RGB颜色空间</h3><h3 id="HSV颜色空间"><a href="#HSV颜色空间" class="headerlink" title="HSV颜色空间"></a>HSV颜色空间</h3><h3 id="抠图需要的颜色空间"><a href="#抠图需要的颜色空间" class="headerlink" title="抠图需要的颜色空间"></a>抠图需要的颜色空间</h3></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/11/05/realsense%E6%B7%B1%E5%BA%A6%E5%9B%BE%E5%83%8F%E8%AF%BB%E5%8F%96%E5%AF%B9%E5%85%B6%E4%B8%8E%E4%BF%9D%E5%AD%98/">realsense深度图像读取对齐与保存</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-11-05</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/realsense/">realsense</a></span><div class="content"><h2 id="图像采集"><a href="#图像采集" class="headerlink" title="图像采集"></a>图像采集</h2><p>realsense直接读取出来的彩色图片和深度图片是没有对齐的，读取出来的两张图片像素之间没有一一对应。但是一般使用两张图片是需要对齐的，并且直接利用深度信息。</p>
<p>以下程序为了更加方便的采集数据。<br>程序运行后q退出，s保存图片。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyrealsense2 <span class="keyword">as</span> rs</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">pipeline = rs.pipeline()</span><br><span class="line"></span><br><span class="line"><span class="comment">#Create a config并配置要流​​式传输的管道</span></span><br><span class="line">config = rs.config()</span><br><span class="line">config.enable_stream(rs.stream.depth, <span class="number">640</span>, <span class="number">480</span>, rs.format.z16, <span class="number">30</span>)</span><br><span class="line">config.enable_stream(rs.stream.color, <span class="number">640</span>, <span class="number">480</span>, rs.format.bgr8, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">profile = pipeline.start(config)</span><br><span class="line"></span><br><span class="line">depth_sensor = profile.get_device().first_depth_sensor()</span><br><span class="line">depth_scale = depth_sensor.get_depth_scale()</span><br><span class="line">print(<span class="string">"Depth Scale is: "</span> , depth_scale)</span><br><span class="line"></span><br><span class="line">align_to = rs.stream.color</span><br><span class="line">align = rs.align(align_to)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按照日期创建文件夹</span></span><br><span class="line">save_path = os.path.join(os.getcwd(), <span class="string">"out"</span>, time.strftime(<span class="string">"%Y_%m_%d_%H_%M_%S"</span>, time.localtime()))</span><br><span class="line">os.mkdir(save_path)</span><br><span class="line">os.mkdir(os.path.join(save_path, <span class="string">"color"</span>))</span><br><span class="line">os.mkdir(os.path.join(save_path, <span class="string">"depth"</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存的图片和实时的图片界面</span></span><br><span class="line">cv2.namedWindow(<span class="string">"live"</span>, cv2.WINDOW_AUTOSIZE)</span><br><span class="line">cv2.namedWindow(<span class="string">"save"</span>, cv2.WINDOW_AUTOSIZE)</span><br><span class="line">saved_color_image = <span class="literal">None</span> <span class="comment"># 保存的临时图片</span></span><br><span class="line">saved_depth_mapped_image = <span class="literal">None</span></span><br><span class="line">saved_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 主循环</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        frames = pipeline.wait_for_frames()</span><br><span class="line"></span><br><span class="line">        aligned_frames = align.process(frames)</span><br><span class="line"></span><br><span class="line">        aligned_depth_frame = aligned_frames.get_depth_frame()</span><br><span class="line">        color_frame = aligned_frames.get_color_frame()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> aligned_depth_frame <span class="keyword">or</span> <span class="keyword">not</span> color_frame:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        depth_data = np.asanyarray(aligned_depth_frame.get_data(), dtype=<span class="string">"float16"</span>)</span><br><span class="line">        depth_image = np.asanyarray(aligned_depth_frame.get_data())</span><br><span class="line">        color_image = np.asanyarray(color_frame.get_data())</span><br><span class="line">        depth_mapped_image = cv2.applyColorMap(cv2.convertScaleAbs(depth_image, alpha=<span class="number">0.03</span>), cv2.COLORMAP_JET)</span><br><span class="line">        cv2.imshow(<span class="string">"live"</span>, np.hstack((color_image, depth_mapped_image)))</span><br><span class="line">        key = cv2.waitKey(<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># s 保存图片</span></span><br><span class="line">        <span class="keyword">if</span> key &amp; <span class="number">0xFF</span> == ord(<span class="string">'s'</span>):</span><br><span class="line">            saved_color_image = color_image</span><br><span class="line">            saved_depth_mapped_image = depth_mapped_image</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 彩色图片保存为png格式</span></span><br><span class="line">            cv2.imwrite(os.path.join((save_path), <span class="string">"color"</span>, <span class="string">"&#123;&#125;.png"</span>.format(saved_count)), saved_color_image)</span><br><span class="line">            <span class="comment"># 深度信息由采集到的float16直接保存为npy格式</span></span><br><span class="line">            np.save(os.path.join((save_path), <span class="string">"depth"</span>, <span class="string">"&#123;&#125;"</span>.format(saved_count)), depth_data)</span><br><span class="line">            saved_count+=<span class="number">1</span></span><br><span class="line">            cv2.imshow(<span class="string">"save"</span>, np.hstack((saved_color_image, saved_depth_mapped_image)))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># q 退出</span></span><br><span class="line">        <span class="keyword">if</span> key &amp; <span class="number">0xFF</span> == ord(<span class="string">'q'</span>) <span class="keyword">or</span> key == <span class="number">27</span>:</span><br><span class="line">            cv2.destroyAllWindows()</span><br><span class="line">            <span class="keyword">break</span>    </span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    pipeline.stop()</span><br></pre></td></tr></table></figure>
<p><img src="https://ximikang-ciu.oss-cn-beijing.aliyuncs.com/img/20201105134623.png?x-oss-process=style/common" alt=""></p>
<h2 id="保存后的图像读取"><a href="#保存后的图像读取" class="headerlink" title="保存后的图像读取"></a>保存后的图像读取</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    color_image = cv2.imread(<span class="string">"./0.png"</span>)</span><br><span class="line">    depth_image = np.load(<span class="string">"./0.npy"</span>)</span><br><span class="line"></span><br><span class="line">    cv2.imshow(<span class="string">"color"</span>, color_image)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取到的深度信息/1000 为真实的深度信息，单位为m</span></span><br><span class="line">    <span class="comment"># truth_depth = depth_image[x, y]/1000</span></span><br><span class="line">    <span class="comment"># 如果深度信息为0, 则说明没有获取到</span></span><br><span class="line">    plt.imshow(depth_image.astype(np.int), <span class="string">"gray"</span>)</span><br><span class="line">    plt.show()</span><br><span class="line">    cv2.waitKey()</span><br></pre></td></tr></table></figure></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/10/29/nginx%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/">windows下nginx搭建文件服务器附带基本验证功能</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-10-29</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/nginx/">nginx</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a></span><div class="content"><h1 id="windows下nginx搭建文件服务器附带基本验证功能"><a href="#windows下nginx搭建文件服务器附带基本验证功能" class="headerlink" title="windows下nginx搭建文件服务器附带基本验证功能"></a>windows下nginx搭建文件服务器附带基本验证功能</h1><h2 id="配置nginx"><a href="#配置nginx" class="headerlink" title="配置nginx"></a>配置nginx</h2><p>在nginx的配置文件中添加如下配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       7777 default_server;</span><br><span class="line">    listen       [::]:7777 default_server;</span><br><span class="line"></span><br><span class="line">    location &#x2F; &#123;</span><br><span class="line">        # 文件目录</span><br><span class="line">        alias D:&#x2F;share;</span><br><span class="line">        # 基本验证</span><br><span class="line">        auth_basic &quot;nginx basic auth&quot;;</span><br><span class="line">        auth_basic_user_file C:&#x2F;nginx&#x2F;conf&#x2F;htpasswd;</span><br><span class="line">        # 文件显示功能</span><br><span class="line">        autoindex on;    #开启索引功能</span><br><span class="line">        autoindex_exact_size off;  #关闭计算文件确切大小（单位bytes），只显示大概大小（单位kb、mb、gb）</span><br><span class="line">        autoindex_localtime on;   #显示本机时间而非 GMT 时间</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="新建用户文件"><a href="#新建用户文件" class="headerlink" title="新建用户文件"></a>新建用户文件</h2><p>在C:/nginx/conf中新建htpasswd文件,按照如下的排列方式新建用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username:password</span><br></pre></td></tr></table></figure>

<h2 id="reload-nginx"><a href="#reload-nginx" class="headerlink" title="reload nginx"></a>reload nginx</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx.exe -s reload</span><br></pre></td></tr></table></figure>
<p>在网站上输入账户和密码即可以访问文件服务</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/09/18/orbslam2%E5%AE%89%E8%A3%85%E4%B8%AD%E7%9A%84%E9%97%AE%E9%A2%98%E5%92%8C%E6%8A%A5%E9%94%99/">ORBslam2安装中的问题和报错</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-09-18</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/slam/">slam</a></span><div class="content"><h1 id="安装中出现的报错问题以及解决方案"><a href="#安装中出现的报错问题以及解决方案" class="headerlink" title="安装中出现的报错问题以及解决方案"></a>安装中出现的报错问题以及解决方案</h1><h2 id="无法找到lib"><a href="#无法找到lib" class="headerlink" title="无法找到lib"></a>无法找到lib</h2><ul>
<li><p>报错信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">make[1]: *** Waiting for unfinished jobs....</span><br><span class="line">collect2: error: ld returned 1 exit status</span><br><span class="line">CMakeFiles/Stereo.dir/build.make:203: recipe for target '../Stereo' failed</span><br><span class="line">make[2]: *** [../Stereo] Error 1</span><br><span class="line">CMakeFiles/Makefile2:104: recipe for target 'CMakeFiles/Stereo.dir/all' failed</span><br><span class="line">make[1]: *** [CMakeFiles/Stereo.dir/all] Error 2</span><br><span class="line">Makefile:129: recipe for target 'all' failed</span><br><span class="line">make: *** [all] Error 2</span><br></pre></td></tr></table></figure></li>
<li><p>解决方案<br>在<code>Examples/ROS/ORB_SLAM2/CMakeLists.txt</code>文件中添加编译信息-lboost_systema</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">	<span class="keyword">set</span>(LIBS </span><br><span class="line"><span class="variable">$&#123;OpenCV_LIBS&#125;</span> </span><br><span class="line"><span class="variable">$&#123;EIGEN3_LIBS&#125;</span></span><br><span class="line"><span class="variable">$&#123;Pangolin_LIBRARIES&#125;</span></span><br><span class="line"><span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/../../../Thirdparty/DBoW2/lib/libDBoW2.so</span><br><span class="line"><span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/../../../Thirdparty/g2o/lib/libg2o.so</span><br><span class="line"><span class="variable">$&#123;PROJECT_SOURCE_DIR&#125;</span>/../../../lib/libORB_SLAM2.so</span><br><span class="line">-lboost_systema <span class="comment">## 添加这一项</span></span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<h2 id="无法找到ros-package-或者ros"><a href="#无法找到ros-package-或者ros" class="headerlink" title="无法找到ros package 或者ros"></a>无法找到ros package 或者ros</h2></li>
<li><p>测试方式</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo $ROS_ROOT</span><br><span class="line">  /opt/ros/melodic/share/ros</span><br><span class="line">echo $ROS_PACKAGE_PATH</span><br><span class="line">  /opt/ros/melodic/share:/home/test/slam/ORB_SLAM2-master/Examples/ROS/ORB_SLAM2</span><br></pre></td></tr></table></figure></li>
<li><p>解决方案</p>
<p>用户目录的.bashrc中添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 有顺序要求 添加ros_root path</span><br><span class="line">source &#x2F;opt&#x2F;ros&#x2F;melodic&#x2F;setup.bash  </span><br><span class="line"># 添加ros_package_path</span><br><span class="line">export ROS_PACKAGE_PATH&#x3D;$&#123;ROS_PACKAGE_PATH&#125;:&#x2F;home&#x2F;test&#x2F;slam&#x2F;ORB_SLAM2-master&#x2F;Examples&#x2F;ROS&#x2F;ORB_SLAM2</span><br></pre></td></tr></table></figure>
<p>应用添加的环境变量<br>source ~/.bashrc</p>
</li>
</ul>
<h2 id="编译pongoline出错"><a href="#编译pongoline出错" class="headerlink" title="编译pongoline出错"></a>编译pongoline出错</h2><blockquote>
<p><a href="https://github.com/raulmur/ORB_SLAM2/issues/22" target="_blank" rel="noopener">https://github.com/raulmur/ORB_SLAM2/issues/22</a></p>
</blockquote>
<ul>
<li>解决方案<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/stevenlovegrove/Pangolin.git</span><br><span class="line">cd Pangolin</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake -DCPP11_NO_BOOST=1 ..</span><br><span class="line">make -j1</span><br><span class="line">Then,</span><br><span class="line">cd ORB_SLAM2</span><br><span class="line">chmod +x build.sh</span><br><span class="line">./build.sh</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="Resource-not-found-rgbd-launch"><a href="#Resource-not-found-rgbd-launch" class="headerlink" title="Resource not found: rgbd_launch"></a>Resource not found: rgbd_launch</h2><ul>
<li>解决方案<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ros-melodic-rgbd-launch</span><br></pre></td></tr></table></figure>


</li>
</ul>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/09/17/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86%E7%9B%91%E6%8E%A7%E4%BD%BF%E7%94%A8html%E6%92%AD%E6%94%BE/">海康威视监控使用html播放</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-09-17</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/html/">html</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86/">海康威视</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/hls/">hls</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/rtsp/">rtsp</a></span><div class="content"><h2 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h2><ul>
<li>rtsp<br>  无法直接在网页端播放，需要插件的支持。不考虑。</li>
<li>rtmp<br>  可以在网页播放，但是播放器需要flash的支持，chrome在2020年后对flash的支持十分不友好,但是延迟比较底。</li>
<li>hls<br>  可以在网页播放，也不需要插件和flash的支持，但是缺点在于hls将网页进行切片传输，每次切片都会造成时间的延迟，而且在网络不好的地方，视频会有克顿和无法播放的现象。</li>
</ul>
<p><strong>本文使用ffmpeg对网络镜头的视频流进行转码为hls，通过nginx进行代理，网页端通过hls.js显示网络镜头的画面。</strong></p>
<h2 id="ffmpeg转码为hls"><a href="#ffmpeg转码为hls" class="headerlink" title="ffmpeg转码为hls"></a>ffmpeg转码为hls</h2><p>通过ffmpeg将rtsp转码为hls，转码的输入为网络摄像机的子码流，视频和音频的解码直接使用镜头的解码编码器h264和acc。-hls_time 为 hls切片的时间间隔，时间越短则延迟越低，但是传输的带宽越大对服务器要求更高，-hls_list_size为.m3u8文件的长度，-hls_wrap为本地交换文件的大小。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">start ffmpeg ^</span><br><span class="line">-i rtsp://username:password@192.168.1.123/Streaming/Channels/102?transportmode=unicast  ^</span><br><span class="line">-c copy ^</span><br><span class="line">-f   hls  ^</span><br><span class="line">-hls_time 1.0 ^</span><br><span class="line">-hls_list_size 2 ^</span><br><span class="line">-hls_wrap   2  ^</span><br><span class="line"> C:/nginx-1.19.2/html/hls/test.m3u8</span><br></pre></td></tr></table></figure>
<h2 id="搭建nginx并配置"><a href="#搭建nginx并配置" class="headerlink" title="搭建nginx并配置"></a>搭建nginx并配置</h2><p>nginx.conf配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#user  nobody;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">#error_log  logs&#x2F;error.log;</span><br><span class="line">#error_log  logs&#x2F;error.log  notice;</span><br><span class="line">#error_log  logs&#x2F;error.log  info;</span><br><span class="line"></span><br><span class="line">#pid        logs&#x2F;nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application&#x2F;octet-stream;</span><br><span class="line">    # 跨域访问</span><br><span class="line">    add_header Access-Control-Allow-Origin *;</span><br><span class="line">    add_header Access-Control-Allow-Headers X-Requested-With;</span><br><span class="line">    add_header Access-Control-Allow-Methods GET,POST,OPTIONS;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    #access_log  logs&#x2F;access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs&#x2F;host.access.log  main;</span><br><span class="line"></span><br><span class="line">        location &#x2F; &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="前端视频显示"><a href="#前端视频显示" class="headerlink" title="前端视频显示"></a>前端视频显示</h2><p>前端为了能够播放hls, 使用hls.js播放直播视频，hls.js不需要任何的播放器，可以直接在video元素上运行</p>
<blockquote>
<p><a href="https://www.npmjs.com/package/hls.js/v/canary" target="_blank" rel="noopener">https://www.npmjs.com/package/hls.js/v/canary</a></p>
</blockquote>
<ul>
<li><p>html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hls test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hls test<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/hls.js@latest"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">video</span> <span class="attr">id</span>=<span class="string">"video"</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">var</span> video = <span class="built_in">document</span>.getElementById(<span class="string">'video'</span>);</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 视频的路径</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> videoSrc = <span class="string">'http://localhost/hls/test.m3u8'</span>;</span></span><br><span class="line">        if (Hls.isSupported()) &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> hls = <span class="keyword">new</span> Hls();</span></span><br><span class="line">            hls.loadSource(videoSrc);</span><br><span class="line">            hls.attachMedia(video);</span><br><span class="line"><span class="actionscript">            hls.on(Hls.Events.MANIFEST_PARSED, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line">                video.play();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="actionscript">        <span class="keyword">else</span> <span class="keyword">if</span> (video.canPlayType(<span class="string">'application/vnd.apple.mpegurl'</span>)) &#123;</span></span><br><span class="line">            video.src = videoSrc;</span><br><span class="line"><span class="actionscript">            video.addEventListener(<span class="string">'loadedmetadata'</span>, <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line">                video.play();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>vue</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">video</span> <span class="attr">ref</span>=<span class="string">"videoRef"</span> <span class="attr">height</span>=<span class="string">"500px"</span> <span class="attr">autoplay</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> Hls <span class="keyword">from</span> <span class="string">'hls.js'</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line">    data() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">            hls:<span class="string">''</span></span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"><span class="actionscript">    mounted: <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> videoRef = <span class="keyword">this</span>.$refs.videoRef</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> url = <span class="string">'http://localhost/hls/test.m3u8'</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.hls = <span class="keyword">new</span> Hls();</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.hls.loadSource(url)</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.hls.attachMedia(<span class="keyword">this</span>.$refs.videoRef)</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.hls.on(Hls.Events.MANIFEST_PARSED, () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'加载成功'</span>);</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.$refs.video.play();</span></span><br><span class="line">          &#125;);</span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.hls.on(Hls.Events.ERROR, (event, data) =&gt; &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'加载失败'</span>);</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="最终显示效果"><a href="#最终显示效果" class="headerlink" title="最终显示效果"></a>最终显示效果</h2><p><img src="https://ximikang-ciu.oss-cn-beijing.aliyuncs.com/img/20200916173720.png?x-oss-process=style/common" alt=""></p>
<p>视频的延迟大概有3-4秒，对于实时性较高的应用还是达不到要求。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/08/13/vmware%E4%BD%BF%E7%94%A8%E4%B8%BB%E6%9C%BA%E4%BB%A3%E7%90%86/">vmware使用主机代理</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-08-13</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/vmware/">vmware</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/proxy/">proxy</a></span><div class="content"><h2 id="主机配置"><a href="#主机配置" class="headerlink" title="主机配置"></a>主机配置</h2><p>主机的配置主要为了虚拟机可以使用主机的网络。</p>
<h3 id="代理配置"><a href="#代理配置" class="headerlink" title="代理配置"></a>代理配置</h3><p>通常使用ssr作为科学上网的工具，如果需要虚拟机使用代理，则需要打开ssr设置中的本地代理，并允许局域网的连接。<br>这样通过此端口的流量就可以通过ssr，流量的pac和代理规则也交付个ssr进行控制。<br>一般配置代理端口为1080端口</p>
<p><img src="https://ximikang-ciu.oss-cn-beijing.aliyuncs.com/img/20200813113025.png?x-oss-process=style/common" alt=""></p>
<h3 id="vmware-网络配置"><a href="#vmware-网络配置" class="headerlink" title="vmware 网络配置"></a>vmware 网络配置</h3><p>vmware虚拟机使用Nat模式，这样相当于主机为一个路由器，可以给每个虚拟机分配ip地址。访问主机也就是访问网络的网关。</p>
<p><img src="https://ximikang-ciu.oss-cn-beijing.aliyuncs.com/img/20200813113439.png?x-oss-process=style/common" alt=""></p>
<h2 id="ubuntu配置"><a href="#ubuntu配置" class="headerlink" title="ubuntu配置"></a>ubuntu配置</h2><p>主要配置浏览器的访问和终端的访问</p>
<h3 id="浏览器配置"><a href="#浏览器配置" class="headerlink" title="浏览器配置"></a>浏览器配置</h3><p>通过设置<code>setting-&gt; network -&gt; network Proxy</code><br>设置为Manual模式,使用http或socks代理，地址为主机的地址可以通过主机的ipconfig查看，一般为VMnet8网卡的地址。</p>
<p><img src="https://ximikang-ciu.oss-cn-beijing.aliyuncs.com/img/20200813112643.png?x-oss-process=style/common" alt=""></p>
<p>端口号为主机设置的对应端口</p>
<p><img src="https://ximikang-ciu.oss-cn-beijing.aliyuncs.com/img/20200813112218.png?x-oss-process=style/common" alt=""></p>
<h3 id="终端配置"><a href="#终端配置" class="headerlink" title="终端配置"></a>终端配置</h3><p>以上的代理配置仅限于浏览器的使用，对于终端的程序是没有用的。<br>通常的终端应用都可以通过自身的proxy代理配置，比如git, wget, apt.但是每个应用都得重新配置一次，为了方便的快捷的使用代理，在终端可以借助<code>proxychains</code>工具进行方便的代理访问。</p>
<blockquote>
<p><a href="https://github.com/haad/proxychains" target="_blank" rel="noopener">https://github.com/haad/proxychains</a></p>
</blockquote>
<p>在ubuntu中可以使用apt安装proxychains</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install proxychains</span><br></pre></td></tr></table></figure>
<p>通过 <strong>/etc/proxychains.conf</strong> 配置代理</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ProxyList format</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       <span class="built_in">type</span>  host  port [user pass]</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       (values separated by <span class="string">'tab'</span> or <span class="string">'blank'</span>)</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        Examples:</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">               socks5  192.168.67.78   1080    lamer   secret</span></span><br><span class="line"><span class="meta">#</span><span class="bash">               http    192.168.89.3    8080    justu   hidden</span></span><br><span class="line"><span class="meta">#</span><span class="bash">               socks4  192.168.1.49    1080</span></span><br><span class="line"><span class="meta">#</span><span class="bash">               http    192.168.39.93   8080    </span></span><br><span class="line"><span class="meta">#</span><span class="bash">               </span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash">       proxy types: http, socks4, socks5</span></span><br><span class="line"><span class="meta">#</span><span class="bash">        ( auth types supported: <span class="string">"basic"</span>-http  <span class="string">"user/pass"</span>-socks )</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line">[ProxyList]</span><br><span class="line"><span class="meta">#</span><span class="bash"> add proxy here ...</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> meanwile</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> defaults <span class="built_in">set</span> to <span class="string">"tor"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在最后添加配置文件</span></span><br><span class="line">http 192.168.164.1 1080</span><br><span class="line">socks5 192.168.1.123 1080</span><br></pre></td></tr></table></figure>
<p>可能会出现找不到libproxychains.so.3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find &#x2F;usr -name &quot;libproxychains.so.3&quot;</span><br><span class="line">&#x2F;usr&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libproxychains.so.3</span><br></pre></td></tr></table></figure>
<p>将对应的路径添加到/usr/bin/proxychains中的LD_PRELOAD中。</p>
<h4 id="usage-example"><a href="#usage-example" class="headerlink" title="usage example"></a>usage example</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo proxychains apt update</span><br><span class="line"></span><br><span class="line">#proxychains ping google.com</span><br><span class="line"># 这条命令不会起作用，因为proxychains只能代理TCP连接，ping命令通过ICMP协议作用</span><br></pre></td></tr></table></figure>

</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/08/12/realsense/">ubuntu18.04 安装librealsense并验证</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-08-12</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/realsense/">realsense</a></span><div class="content"><h2 id="安装环境"><a href="#安装环境" class="headerlink" title="安装环境"></a>安装环境</h2><p><code>OS: Ubuntu 18.04 bionic</code><br><code>Kernel: x86_64 Linux 4.15.0-20-generic</code></p>
<p><code>测试通过了vmware station开启的虚拟机ubuntu18.04</code></p>
<h2 id="安装Realsense-SDK"><a href="#安装Realsense-SDK" class="headerlink" title="安装Realsense SDK"></a>安装Realsense SDK</h2><blockquote>
<p>参考<a href="https://github.com/IntelRealSense/librealsense/blob/master/doc/distribution_linux.md" target="_blank" rel="noopener">https://github.com/IntelRealSense/librealsense/blob/master/doc/distribution_linux.md</a></p>
</blockquote>
<p>以前的Librealsense需要编译进行安装,但是对于Ubuntu LTS kernels 4.4, 4.8, 4.10, 4.13, 4.15, 4.18* 5.0* 5.3*可以使用apt 直接进行安装。</p>
<p>建议使用科学上网进行安装，否则会下载很慢</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 注册public key</span></span><br><span class="line">sudo apt-key adv --keyserver keys.gnupg.net --recv-key F6E65AC044F831AC80A06380C8B3A55A6F3EFCDE || sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-key F6E65AC044F831AC80A06380C8B3A55A6F3EFCDE</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加apt repository</span></span><br><span class="line">sudo add-apt-repository "deb http://realsense-hw-public.s3.amazonaws.com/Debian/apt-repo bionic main" -u</span><br><span class="line"><span class="meta">#</span><span class="bash"> ubuntu 16可以换为</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sudo add-apt-repository <span class="string">"deb http://realsense-hw-public.s3.amazonaws.com/Debian/apt-repo xenial main"</span> -u</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装librealsense</span></span><br><span class="line">sudo apt-get install librealsense2-dkms</span><br><span class="line">sudo apt-get install librealsense2-utils</span><br></pre></td></tr></table></figure>

<h2 id="验证是否安装成功"><a href="#验证是否安装成功" class="headerlink" title="验证是否安装成功"></a>验证是否安装成功</h2><p>重新连接RealSense相机并运行<code>realsense-viewer</code>去验证是否安装成功<br><img src="https://ximikang-ciu.oss-cn-beijing.aliyuncs.com/img/20200812194410.png?x-oss-process=style/common" alt=""></p>
<h2 id="升级librealsense"><a href="#升级librealsense" class="headerlink" title="升级librealsense"></a>升级librealsense</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure>

<h2 id="卸载librealsense"><a href="#卸载librealsense" class="headerlink" title="卸载librealsense"></a>卸载librealsense</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 卸载所有的realsense相关的安装包</span></span><br><span class="line">dpkg -l | grep "realsense" | cut -d " " -f 3 | xargs sudo dpkg --purge</span><br></pre></td></tr></table></figure>

<h2 id="相关安装包的内容和依赖"><a href="#相关安装包的内容和依赖" class="headerlink" title="相关安装包的内容和依赖"></a>相关安装包的内容和依赖</h2><table>
<thead>
<tr>
<th>Name</th>
<th>Content</th>
<th>Depends on</th>
</tr>
</thead>
<tbody><tr>
<td>librealsense2-udev-rules</td>
<td>Configures RealSense device permissions on kernel level</td>
<td>-</td>
</tr>
<tr>
<td>librealsense2-dkms</td>
<td>DKMS package for Depth cameras-specific kernel extensions</td>
<td>librealsense2-udev-rules</td>
</tr>
<tr>
<td>librealsense2</td>
<td>RealSense™ SDK runtime (.so) and configuration files</td>
<td>librealsense2-udev-rules</td>
</tr>
<tr>
<td>librealsense2-utils</td>
<td>Demos and tools available as a part of RealSense™ SDK</td>
<td>librealsense2</td>
</tr>
<tr>
<td>librealsense2-dev</td>
<td>Header files and symbolic link for developers</td>
<td>librealsense2</td>
</tr>
<tr>
<td>librealsense2-dbg</td>
<td>Debug symbols for developers</td>
<td>librealsense2</td>
</tr>
</tbody></table>
<p>可以按照需求进行安装</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/07/18/use-iperf/">使用iperf进行内网测速</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-07-18</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a></span><div class="content"><p>一般的测速网站或者是常用的测速软件如speedtest通常都只能测试外网的连接的速度，但是对于在局域网内部的设备之间测速是没有办法解决的。</p>
<p>iperf 可以测试网络的性能，并且方便搭建，只需要命令行就可以快速对局域网进行网络性能的测试。</p>
<h1 id="下载和安装"><a href="#下载和安装" class="headerlink" title="下载和安装"></a>下载和安装</h1><p>下载网站：<a href="https://iperf.fr/iperf-download.php" target="_blank" rel="noopener">iperf download</a></p>
<ul>
<li><a href="https://iperf.fr/iperf-download.php#windows" target="_blank" rel="noopener">windows</a></li>
<li><a href="https://iperf.fr/iperf-download.php#ubuntu" target="_blank" rel="noopener">ubuntu</a><br>解压就可以运行</li>
</ul>
<h1 id="最简单的使用方式"><a href="#最简单的使用方式" class="headerlink" title="最简单的使用方式"></a>最简单的使用方式</h1><p>再windows上打开下载的文件夹<br>将一台电脑作为服务端：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">iperf3 -s</span><br><span class="line"><span class="comment"># windows</span></span><br><span class="line">iperf3.exe -s</span><br></pre></td></tr></table></figure>
<p>另外一台电脑作为客户端：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iperf3 -c 服务器ip</span><br></pre></td></tr></table></figure>

<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>服务器端新建服务器</p>
<p><img src="https://ximikang-ciu.oss-cn-beijing.aliyuncs.com/img/20200718102943.png?x-oss-process=style/common" alt=""><br>客户端新建连接进行测速<br><img src="https://ximikang-ciu.oss-cn-beijing.aliyuncs.com/img/20200718102646.png?x-oss-process=style/common" alt=""></p>
<p>需要注意的是在服务器端需要开启5201端口或设置其他端口，或者关闭防火墙。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/03/04/build-code-server/">docker-componse搭建code-server服务</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-03-04</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/docker-componse/">docker-componse</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/vscode/">vscode</a></span><div class="content"><blockquote>
<p>code-server is vscode running on a remote server, accessibale throught the browser.<br>code-server就是一个可以搭建在服务器上的远程vscode，并且我们可以直接用browser直接访问,本来的初衷是为了写blog可以直接在浏览器中写，而不是每次必须打开vscode，后来发现code-server也可以用在ipad上，兼容性还不错<br>参考自：<strong><a href="https://github.com/cdr/code-server" target="_blank" rel="noopener">https://github.com/cdr/code-server</a></strong></p>
</blockquote>
<h2 id="X00"><a href="#X00" class="headerlink" title="X00"></a>X00</h2><p>使用docker搭建code-server的优势是搭建速度比较快，但是没有办法使用宿主机的环境和配置，如果需要配置需要从头开始配置。</p>
<p>Docker Compose 是 Docker 官方编排（Orchestration）项目之一，负责快速的部署分布式应用。使用docker compose我们的docker命令可以复用，也可以构成更高级的配置文件。</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>新建文件夹<code>mkdir /usr/local/code-server</code> 可以在任意位置，用来存放建立的新工程，打开新建的文件夹<code>cd /usr/local/code-server</code>，新建并编辑docker-compose<code>touch docker-compose.yml &amp;&amp; vim docker-compose.yml</code></p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">version: "3"</span></span><br><span class="line"></span><br><span class="line"><span class="section">services:</span></span><br><span class="line">  code-server:</span><br><span class="line">    container_name: code-server</span><br><span class="line">    image: codercom/code-server</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">"8080:8080"</span></span><br><span class="line">    volumes:</span><br><span class="line">      - <span class="string">"/usr/local/code-server/project:/home/coder/project"</span></span><br><span class="line">    environment:</span><br><span class="line">      PASSWORD: &lt;password&gt;</span><br><span class="line">    restart: always</span><br></pre></td></tr></table></figure>

<ul>
<li>ports<br>  前面为宿主机端口可以改为需要的端口，后面为容器内端口不能更改</li>
<li>volumes<br>  数据卷：前面为新建的文件夹 + ‘project’</li>
<li>restart<br>  容器意外关闭后可以自动重启</li>
</ul>
<h2 id="启动容器"><a href="#启动容器" class="headerlink" title="启动容器"></a>启动容器</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在cocker-compose.yml目录下</span></span><br><span class="line"></span><br><span class="line">docker-compose up <span class="comment">##正常启动</span></span><br><span class="line">docker-compose up -d <span class="comment">##后台启动</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># kill docker container</span></span><br><span class="line">docker ps <span class="comment">#查看对应的code-server id</span></span><br><span class="line">docker <span class="built_in">kill</span> &lt;id&gt;</span><br></pre></td></tr></table></figure>
</div><hr></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fa fa-chevron-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(/images/bk.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2021 By ximikang</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody" target="_blank" rel="noopener"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.7.0"></script><script src="/js/fancybox.js?version=1.7.0"></script><script src="/js/sidebar.js?version=1.7.0"></script><script src="/js/copy.js?version=1.7.0"></script><script src="/js/fireworks.js?version=1.7.0"></script><script src="/js/transition.js?version=1.7.0"></script><script src="/js/scroll.js?version=1.7.0"></script><script src="/js/head.js?version=1.7.0"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>